sequenceDiagram
    participant Data as Input Data
    participant Window as Analysis Window
    participant Trend as Trend Calculator
    participant Trigger as Trigger Logic
    participant Filter as Optional Filter

    Data->>Filter: Raw signal points
    alt Filter Enabled
        Filter->>Filter: Apply lowpass (f=50kHz)
        Filter->>Window: Filtered signal
    else Filter Disabled
        Data->>Window: Raw signal points
    end
    Window->>Window: Get 5-point window
    Window->>Trend: Calculate slope
    Note over Trend: Least squares method
    Trend->>Trigger: Return trend direction
    Trigger->>Trigger: Check level crossing
    Note over Trigger: Compare with<br>hysteresis band (25%)
    alt Valid Trigger
        Trigger->>Trigger: Check operating mode
        alt Single Shot Mode
            Trigger->>Data: Stop acquisition
        else Normal Mode
            Trigger->>Trigger: Wait for band exit
        end
    end